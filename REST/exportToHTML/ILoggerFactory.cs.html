<html>
<head>
<title>ILoggerFactory.cs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #85c46c; font-style: italic;}
.s1 { color: #d0d0d0;}
</style>
</head>
<body bgcolor="#262626">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
ILoggerFactory.cs</font>
</center></td></tr></table>
<pre><span class="s0">// using System.Diagnostics;</span>
<span class="s0">// using log4net.Core;</span>
<span class="s0">// using ILogger = log4net.Core.ILogger;</span>
<span class="s0">// using DMS.REST.Logging;</span>

<span class="s0">// namespace DMS.REST.Logging</span>
<span class="s0">// {</span>
<span class="s0">//     /// &lt;summary&gt;</span>
<span class="s0">//     /// Wraps the log4j2 logger instances by realizing interface ILoggerWrapper.</span>
<span class="s0">//     /// This avoids direct dependencies to log4j2 package.</span>
<span class="s0">//     /// &lt;/summary&gt;</span>
<span class="s0">//     public class Log4NetWrapper : ILoggerWrapper</span>
<span class="s0">//     {</span>
<span class="s0">//         private readonly log4net.ILog logger;</span>
<span class="s0">//         public ILogger Logger { get; }</span>
<span class="s0">//         private static Log4NetWrapper? _loggerWrapper = null;</span>

<span class="s0">//         public static Log4NetWrapper CreateLogger(string configPath, string caller) // BUG doesn't return loggerWrapper</span>
<span class="s0">//         {</span>
<span class="s0">//             // if (_loggerWrapper is not null) return _loggerWrapper;</span>

<span class="s0">//             if (!File.Exists(configPath))</span>
<span class="s0">//             {</span>
<span class="s0">//                 throw new ArgumentException(&quot;Does not exist.&quot;, nameof(configPath));</span>
<span class="s0">//             }</span>

<span class="s0">//             log4net.Config.XmlConfigurator.Configure(new FileInfo(configPath));</span>
<span class="s0">//             var logger =</span>
<span class="s0">//                 log4net.LogManager.GetLogger(caller); // System.Reflection.MethodBase.GetCurrentMethod().DeclaringType</span>
<span class="s0">//             return new Log4NetWrapper(logger);</span>
<span class="s0">//             // return _loggerWrapper;</span>
<span class="s0">//         }</span>

<span class="s0">//         private Log4NetWrapper(log4net.ILog logger)</span>
<span class="s0">//         {</span>
<span class="s0">//             this.logger = logger;</span>
<span class="s0">//         }</span>

<span class="s0">//         public void Debug(string message)</span>
<span class="s0">//         {</span>
<span class="s0">//             this.logger.Debug(message);</span>
<span class="s0">//         }</span>

<span class="s0">//         public void Warn(string message)</span>
<span class="s0">//         {</span>
<span class="s0">//             this.logger.Warn(message);</span>
<span class="s0">//         }</span>

<span class="s0">//         public void Error(string message)</span>
<span class="s0">//         {</span>
<span class="s0">//             this.logger.Error(message);</span>
<span class="s0">//         }</span>

<span class="s0">//         public void Fatal(string message)</span>
<span class="s0">//         {</span>
<span class="s0">//             this.logger.Fatal(message);</span>
<span class="s0">//         }</span>

<span class="s0">//         public void Info(string message)</span>
<span class="s0">//         {</span>
<span class="s0">//             this.logger.Info(message);</span>
<span class="s0">//         }</span>
<span class="s0">//     }</span>

<span class="s0">//     public interface ILoggerWrapper</span>
<span class="s0">//     {</span>
<span class="s0">//         void Debug(string message);</span>
<span class="s0">//         void Error(string message);</span>
<span class="s0">//         void Fatal(string message);</span>
<span class="s0">//         void Warn(string message);</span>
<span class="s0">//         void Info(string message);</span>
<span class="s0">//     }</span>


<span class="s0">//     public static class LoggerFactory</span>
<span class="s0">//     {</span>
<span class="s0">//         public static ILoggerWrapper GetLogger()</span>
<span class="s0">//         {</span>
<span class="s0">//             StackTrace</span>
<span class="s0">//                 stackTrace = new(1, false); //Captures 1 frame, false for not collecting information about the file</span>
<span class="s0">//             var type = stackTrace.GetFrame(1).GetMethod().DeclaringType;</span>
<span class="s0">//             return Log4NetWrapper.CreateLogger(&quot;./log4net.config&quot;, type?.FullName ?? string.Empty);</span>
<span class="s0">//         }</span>
<span class="s0">//     }</span>
<span class="s0">// }</span></pre>
</body>
</html>