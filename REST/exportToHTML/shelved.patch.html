<html>
<head>
<title>shelved.patch</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #d0d0d0;}
</style>
</head>
<body bgcolor="#262626">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
shelved.patch</font>
</center></td></tr></table>
<pre><span class="s0">Index: DMS.Api/Program.cs 
IDEA additional info: 
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP 
&lt;+&gt;using System.Reflection;\nusing DMS.Application.Commands;\nusing DMS.Domain;\nusing DMS.Domain.Entities.DomainEvents;\nusing DMS.Domain.IRepositories;\nusing DMS.Infrastructure;\nusing DMS.Infrastructure.EventHandlers;\nusing DMS.Infrastructure.Repositories;\nusing DMS.Infrastructure.Services;\nusing log4net;\nusing log4net.Config;\nusing Microsoft.EntityFrameworkCore;\n// using DMS.Domain.Repositories;\n// using DMS.Infrastructure.Repositories;\n// using DMS.Infrastructure.Persistence;\nusing MediatR;\n\nvar builder = WebApplication.CreateBuilder(args);\nbuilder.Services.AddCors(options =&gt;\n{\n    options.AddPolicy(\&quot;AllowAllOrigins\&quot;,\n        builder =&gt;\n        {\n            builder.AllowAnyOrigin()\n                .AllowAnyMethod()\n                .AllowAnyHeader();\n        });\n});\nbuilder.Services.AddMediatR(\n    typeof(UploadDocumentCommand).Assembly\n    );\n\nbuilder.Services.AddControllers();\nbuilder.Services.AddEndpointsApiExplorer();\nbuilder.Services.AddSwaggerGen();\n\n\n// use log4net for logging\nvar logRepository = LogManager.GetRepository(Assembly.GetEntryAssembly());\nXmlConfigurator.Configure(logRepository, new FileInfo(\&quot;log4net.config\&quot;));\n\n// Clear default logging providers and add log4net\nbuilder.Logging.ClearProviders();  // Remove other logging providers (optional)\nbuilder.Logging.AddLog4Net();  \n// Add PostgreSQL support with Entity Framework Core\n//var connectionString = builder.Configuration.GetConnectionString(\&quot;DefaultConnection\&quot;);\n//builder.Services.AddDbContext&lt;DMSDbContext&gt;(options =&gt;\n//options.UseNpgsql(connectionString));\n\n// Register repositories and services\nbuilder.Services.AddScoped&lt;IDomainEventDispatcher, DomainEventDispatcher&gt;();\nbuilder.Services.AddScoped&lt;IDomainEventHandler&lt;DocumentUploadedEvent&gt;, DocumentCreatedEventHandler&gt;();\nbuilder.Services.AddScoped&lt;IMessageBrokerClient, RabbitMqClient&gt;();\nbuilder.Services.AddScoped&lt;IDmsDocumentRepository, DmsDocumentRepository&gt;();\nbuilder.Services.AddScoped&lt;ITagRepository, TagRepository&gt;();\n// builder.Services.AddScoped&lt;IProductRepository, ProductRepository&gt;();\n// builder.Services.AddScoped&lt;IProductService, ProductService&gt;();\nvar connectionString = builder.Configuration.GetConnectionString(\&quot;DefaultConnection\&quot;);\n\nbuilder.Services.AddDbContext&lt;DmsDbContext&gt;(options =&gt;\n    options.UseNpgsql(connectionString));\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (app.Environment.IsDevelopment())\n{\n    app.UseSwagger();\n    app.UseSwaggerUI();\n}\n\napp.UseCors(\&quot;AllowAllOrigins\&quot;);\napp.UseHttpsRedirection();\napp.UseAuthorization();\napp.MapControllers();\n\nConsole.WriteLine(\&quot;Starting REST API\&quot;);\n\napp.Run(); 
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP 
&lt;+&gt;UTF-8 
=================================================================== 
diff --git a/DMS.Api/Program.cs b/DMS.Api/Program.cs 
--- a/DMS.Api/Program.cs    (revision 5cb5cc13aeac33cfd4ed9ab47a4e72f09e547b57) 
+++ b/DMS.Api/Program.cs    (date 1729265346625) 
@@ -48,8 +48,8 @@ 
 //options.UseNpgsql(connectionString)); 
  
 // Register repositories and services 
-builder.Services.AddScoped&lt;IDomainEventDispatcher, DomainEventDispatcher&gt;(); 
-builder.Services.AddScoped&lt;IDomainEventHandler&lt;DocumentUploadedEvent&gt;, DocumentCreatedEventHandler&gt;(); 
+builder.Services.AddScoped&lt;IEventDispatcher, EventDispatcher&gt;(); 
+// builder.Services.AddScoped&lt;IDomainEventHandler&lt;DocumentUploadedEvent&gt;, DocumentCreatedEventHandler&gt;(); 
 builder.Services.AddScoped&lt;IMessageBrokerClient, RabbitMqClient&gt;(); 
 builder.Services.AddScoped&lt;IDmsDocumentRepository, DmsDocumentRepository&gt;(); 
 builder.Services.AddScoped&lt;ITagRepository, TagRepository&gt;(); 
</span></pre>
</body>
</html>